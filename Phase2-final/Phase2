final version for phase2
